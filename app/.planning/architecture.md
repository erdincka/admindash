# Architecture Diagram - Phase 1

**Project**: K8s Dashboard v2  
**Date**: 2025-12-03

---

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           User Browser                               â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   Next.js Frontend (Port 3000)                â”‚  â”‚
â”‚  â”‚                                                                â”‚  â”‚
â”‚  â”‚  Components:                                                   â”‚  â”‚
â”‚  â”‚  â”œâ”€ DeploymentForm      (Container Wizard)                    â”‚  â”‚
â”‚  â”‚  â”œâ”€ ResourceTable       (K8s Object Viewer)                   â”‚  â”‚
â”‚  â”‚  â”œâ”€ ChartList           (Helm Chart Management)               â”‚  â”‚
â”‚  â”‚  â””â”€ ErrorBoundary       (Error Handling)                      â”‚  â”‚
â”‚  â”‚                                                                â”‚  â”‚
â”‚  â”‚  State Management:                                             â”‚  â”‚
â”‚  â”‚  â”œâ”€ Zustand Store       (Global state)                        â”‚  â”‚
â”‚  â”‚  â”œâ”€ React Query         (Server state, caching)               â”‚  â”‚
â”‚  â”‚  â””â”€ Socket.IO Client    (WebSocket connection)                â”‚  â”‚
â”‚  â”‚                                                                â”‚  â”‚
â”‚  â”‚  Theme: grommet-theme-hpe (HPE branding)                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚                                      â”‚
â”‚                               â”‚ HTTP + WebSocket                     â”‚
â”‚                               â–¼                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      OAuth2-Proxy (Platform)                         â”‚
â”‚                                                                      â”‚
â”‚  â”œâ”€ Authenticates user with OIDC                                   â”‚
â”‚  â”œâ”€ Injects headers: X-Forwarded-User, X-Forwarded-Email          â”‚
â”‚  â””â”€ Proxies to backend                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FastAPI Backend (Port 8000)                        â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                      API Layer                                â”‚  â”‚
â”‚  â”‚  â”œâ”€ /api/v1/deployments    (Deployment CRUD)                 â”‚  â”‚
â”‚  â”‚  â”œâ”€ /api/v1/resources      (K8s resource viewer)             â”‚  â”‚
â”‚  â”‚  â”œâ”€ /api/v1/charts         (Chart management)                â”‚  â”‚
â”‚  â”‚  â”œâ”€ /api/v1/namespaces     (Namespace list)                  â”‚  â”‚
â”‚  â”‚  â””â”€ /socket.io/            (WebSocket endpoint)              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Middleware                                 â”‚  â”‚
â”‚  â”‚  â”œâ”€ Auth (extract user from headers)                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ Error Handler (global exception handling)                â”‚  â”‚
â”‚  â”‚  â”œâ”€ Logging (request/response logging)                       â”‚  â”‚
â”‚  â”‚  â”œâ”€ CORS (allow frontend origin)                             â”‚  â”‚
â”‚  â”‚  â””â”€ Rate Limiting (prevent abuse)                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Service Layer                              â”‚  â”‚
â”‚  â”‚  â”œâ”€ DeploymentService     (business logic)                   â”‚  â”‚
â”‚  â”‚  â”œâ”€ ResourceService       (K8s operations)                   â”‚  â”‚
â”‚  â”‚  â””â”€ ChartService          (ChartMuseum ops)                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     Core Components                           â”‚  â”‚
â”‚  â”‚  â”œâ”€ K8sAsyncClient        (kubernetes_asyncio wrapper)       â”‚  â”‚
â”‚  â”‚  â”œâ”€ RedisClient           (caching layer)                    â”‚  â”‚
â”‚  â”‚  â”œâ”€ RetryDecorator        (exponential backoff)              â”‚  â”‚
â”‚  â”‚  â””â”€ WebSocketManager      (Socket.IO server)                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                    â”‚                    â”‚
           â”‚                    â”‚                    â”‚
           â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Redis Cache   â”‚   â”‚ K8s API Server â”‚   â”‚  ChartMuseum   â”‚
â”‚  (Port 6379)   â”‚   â”‚  (In-cluster)  â”‚   â”‚   (HTTP API)   â”‚
â”‚                â”‚   â”‚                â”‚   â”‚                â”‚
â”‚ Cache Keys:    â”‚   â”‚ Resources:     â”‚   â”‚ Operations:    â”‚
â”‚ â”œâ”€ namespaces  â”‚   â”‚ â”œâ”€ Deployments â”‚   â”‚ â”œâ”€ List charts â”‚
â”‚ â”œâ”€ deployments â”‚   â”‚ â”œâ”€ Pods        â”‚   â”‚ â”œâ”€ Get chart   â”‚
â”‚ â”œâ”€ charts      â”‚   â”‚ â”œâ”€ Services    â”‚   â”‚ â””â”€ Delete chartâ”‚
â”‚ â””â”€ configmaps  â”‚   â”‚ â”œâ”€ ConfigMaps  â”‚   â”‚                â”‚
â”‚                â”‚   â”‚ â””â”€ Namespaces  â”‚   â”‚                â”‚
â”‚ TTL: 30s-5min  â”‚   â”‚                â”‚   â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Examples

### Example 1: Create Deployment

```
User fills form â†’ Frontend validates â†’ Send POST /api/v1/deployments
                                                    â”‚
                                                    â–¼
                            Backend validates with Pydantic
                                                    â”‚
                                                    â–¼
                            DeploymentService.create()
                                                    â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â–¼                                                 â–¼
            K8sAsyncClient.create_deployment()              RedisClient.invalidate()
                        â”‚                                                 â”‚
                        â–¼                                                 â–¼
            K8s API Server (create resources)              Clear cache keys
                        â”‚
                        â–¼
            WebSocketManager.emit('deployment:progress')
                        â”‚
                        â–¼
            Frontend receives update â†’ Show notification â†’ Refresh list
```

### Example 2: List Resources (with caching)

```
User clicks "Pods" â†’ Frontend sends GET /api/v1/resources/Pod
                                                    â”‚
                                                    â–¼
                            Check Redis cache (key: "pods:all")
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼ (cache hit)                    â–¼ (cache miss)
            Return cached data              K8sAsyncClient.list_pods()
                    â”‚                                â”‚
                    â”‚                                â–¼
                    â”‚                        K8s API Server
                    â”‚                                â”‚
                    â”‚                                â–¼
                    â”‚                        Store in Redis (TTL: 30s)
                    â”‚                                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â–¼
                            Return to frontend
                                     â”‚
                                     â–¼
                            Render ResourceTable
```

### Example 3: Real-Time Updates

```
K8s API Watch        â†’  Backend detects Pod created
     â”‚                           â”‚
     â–¼                           â–¼
K8s event stream    â†’  WebSocketManager.emit('resource:created')
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                          â–¼
            Frontend (subscribed)      Frontend (not subscribed)
                    â”‚                          â”‚
                    â–¼                          â–¼
        Update local state                Do nothing
                    â”‚
                    â–¼
        Show toast notification
                    â”‚
                    â–¼
        Update ResourceTable (no refresh needed)
```

---

## Caching Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Cache Layers                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  Layer 1: Browser (HTTP Cache)                  â”‚
â”‚  â”œâ”€ Static assets: 1 year                       â”‚
â”‚  â”œâ”€ API responses: No cache                     â”‚
â”‚  â””â”€ Next.js pages: Revalidate on demand         â”‚
â”‚                                                  â”‚
â”‚  Layer 2: React Query (Client-side)             â”‚
â”‚  â”œâ”€ Stale time: 30 seconds                      â”‚
â”‚  â”œâ”€ Cache time: 5 minutes                       â”‚
â”‚  â””â”€ Auto refetch on window focus                â”‚
â”‚                                                  â”‚
â”‚  Layer 3: Redis (Server-side)                   â”‚
â”‚  â”œâ”€ Namespaces: 5 minutes                       â”‚
â”‚  â”œâ”€ Deployments: 30 seconds                     â”‚
â”‚  â”œâ”€ Pods: 30 seconds                            â”‚
â”‚  â”œâ”€ ConfigMaps: 2 minutes                       â”‚
â”‚  â””â”€ Charts: 1 minute                            â”‚
â”‚                                                  â”‚
â”‚  Invalidation Triggers:                         â”‚
â”‚  â”œâ”€ Create/Update/Delete operations             â”‚
â”‚  â”œâ”€ WebSocket events                            â”‚
â”‚  â””â”€ Manual refresh button                       â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## WebSocket Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WebSocket Flow                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  Client Connection:                                       â”‚
â”‚  1. const socket = io('http://localhost:8000')           â”‚
â”‚  2. socket.on('connect', () => authenticated)            â”‚
â”‚  3. socket.emit('subscribe:resources', {kind: 'Pod'})    â”‚
â”‚                                                           â”‚
â”‚  Server Side:                                            â”‚
â”‚  1. Verify user from headers                             â”‚
â”‚  2. Create K8s watch for requested resource              â”‚
â”‚  3. Join room: `resources:Pod`                           â”‚
â”‚  4. Emit events to room on K8s changes                   â”‚
â”‚                                                           â”‚
â”‚  K8s Watch â†’ Event Emitter â†’ Socket.IO Room â†’ Clients   â”‚
â”‚                                                           â”‚
â”‚  Client Receives:                                        â”‚
â”‚  socket.on('resource:created', (pod) => {                â”‚
â”‚    queryClient.invalidateQueries(['resources', 'Pod'])   â”‚
â”‚    toast.success(`Pod ${pod.name} created`)              â”‚
â”‚  })                                                       â”‚
â”‚                                                           â”‚
â”‚  Reconnection Logic:                                     â”‚
â”‚  1. Detect disconnect                                    â”‚
â”‚  2. Show "Reconnecting..." indicator                     â”‚
â”‚  3. Auto-retry with exponential backoff                  â”‚
â”‚  4. Re-subscribe to previous rooms                       â”‚
â”‚  5. Fetch latest data                                    â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Handling Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Error Handling Chain                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  Frontend:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  1. Try API call                                 â”‚    â”‚
â”‚  â”‚  2. If fails â†’ Retry decorator (3 attempts)     â”‚    â”‚
â”‚  â”‚  3. If still fails â†’ Catch error                â”‚    â”‚
â”‚  â”‚  4. Show toast notification                      â”‚    â”‚
â”‚  â”‚  5. Log to console (dev) / monitoring (prod)    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                           â”‚
â”‚  Error Boundary:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Catches React component crashes                 â”‚    â”‚
â”‚  â”‚  Shows fallback UI                               â”‚    â”‚
â”‚  â”‚  Logs error details                              â”‚    â”‚
â”‚  â”‚  Provides "Reload" button                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                           â”‚
â”‚  Backend:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  1. Route handler tries operation                â”‚    â”‚
â”‚  â”‚  2. Service layer with retry decorator          â”‚    â”‚
â”‚  â”‚  3. If K8s API error â†’ Custom exception         â”‚    â”‚
â”‚  â”‚  4. Global exception handler catches all        â”‚    â”‚
â”‚  â”‚  5. Format error response                       â”‚    â”‚
â”‚  â”‚  6. Log with context (user, resource, etc.)     â”‚    â”‚
â”‚  â”‚  7. Return standardized error JSON              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                           â”‚
â”‚  Retry Logic (Exponential Backoff):                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Attempt 1: Immediate                            â”‚    â”‚
â”‚  â”‚  Attempt 2: Wait 1 second                        â”‚    â”‚
â”‚  â”‚  Attempt 3: Wait 2 seconds                       â”‚    â”‚
â”‚  â”‚  Attempt 4: Wait 4 seconds (if configured)      â”‚    â”‚
â”‚  â”‚  Give up â†’ Show error to user                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Deployment Architecture (Kubernetes)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Kubernetes Cluster                        â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Ingress (OAuth2-Proxy)                     â”‚ â”‚
â”‚  â”‚  https://dashboard.domain.com                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                            â”‚                                 â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚              â–¼                           â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Frontend Service    â”‚    â”‚  Backend Service     â”‚      â”‚
â”‚  â”‚  (ClusterIP)         â”‚    â”‚  (ClusterIP)         â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚              â”‚                           â”‚                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â–¼                 â–¼         â–¼                â–¼         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚Frontendâ”‚      â”‚Frontendâ”‚ â”‚Backend â”‚      â”‚Backend â”‚    â”‚
â”‚  â”‚ Pod 1  â”‚      â”‚ Pod 2  â”‚ â”‚ Pod 1  â”‚      â”‚ Pod 2  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                   â”‚              â”‚          â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                          â–¼                  â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                              â”‚  Redis Service       â”‚       â”‚
â”‚                              â”‚  (ClusterIP)         â”‚       â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                          â”‚                  â”‚
â”‚                                          â–¼                  â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                              â”‚  Redis Pod           â”‚       â”‚
â”‚                              â”‚  + PVC (persistent)  â”‚       â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                              â”‚
â”‚  Backend ServiceAccount:                                    â”‚
â”‚  â”œâ”€ RBAC Role: read/write deployments, pods, services      â”‚
â”‚  â”œâ”€ RBAC Role: read configmaps, namespaces                 â”‚
â”‚  â””â”€ RBAC Role: create/delete custom resources              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Security Layers                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Layer 1: Network (Ingress)                                 â”‚
â”‚  â”œâ”€ HTTPS only (TLS termination)                           â”‚
â”‚  â”œâ”€ OAuth2-proxy authentication                             â”‚
â”‚  â””â”€ Rate limiting (per IP)                                  â”‚
â”‚                                                              â”‚
â”‚  Layer 2: Application (Backend)                             â”‚
â”‚  â”œâ”€ Verify X-Forwarded-User header                         â”‚
â”‚  â”œâ”€ CORS (allow only frontend domain)                      â”‚
â”‚  â”œâ”€ Input validation (Pydantic schemas)                    â”‚
â”‚  â”œâ”€ SQL injection: N/A (no SQL database)                   â”‚
â”‚  â””â”€ XSS protection: Output sanitization                    â”‚
â”‚                                                              â”‚
â”‚  Layer 3: Kubernetes RBAC                                   â”‚
â”‚  â”œâ”€ Service account with minimal permissions               â”‚
â”‚  â”œâ”€ Can't access secrets in other namespaces              â”‚
â”‚  â”œâ”€ Can't modify cluster-wide resources                   â”‚
â”‚  â””â”€ All actions logged to K8s audit log                   â”‚
â”‚                                                              â”‚
â”‚  Layer 4: Data Protection                                   â”‚
â”‚  â”œâ”€ Secrets sanitized in API responses                     â”‚
â”‚  â”œâ”€ Redis password protected (production)                  â”‚
â”‚  â”œâ”€ No sensitive data in frontend localStorage            â”‚
â”‚  â””â”€ User data isolated by OAuth2 claims                   â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Monitoring & Observability (Future)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Observability Stack                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Metrics (Prometheus):                                      â”‚
â”‚  â”œâ”€ API request duration                                    â”‚
â”‚  â”œâ”€ API error rate                                          â”‚
â”‚  â”œâ”€ Cache hit/miss rate                                     â”‚
â”‚  â”œâ”€ K8s API call rate                                       â”‚
â”‚  â”œâ”€ WebSocket connection count                             â”‚
â”‚  â””â”€ Active user sessions                                    â”‚
â”‚                                                              â”‚
â”‚  Logs (Structured JSON):                                    â”‚
â”‚  â”œâ”€ Request/response logs                                   â”‚
â”‚  â”œâ”€ Error logs with stack traces                           â”‚
â”‚  â”œâ”€ User action logs (audit trail)                         â”‚
â”‚  â””â”€ K8s API operation logs                                 â”‚
â”‚                                                              â”‚
â”‚  Traces (OpenTelemetry - future):                           â”‚
â”‚  â”œâ”€ End-to-end request tracing                             â”‚
â”‚  â”œâ”€ K8s API call spans                                      â”‚
â”‚  â”œâ”€ Redis operation spans                                   â”‚
â”‚  â””â”€ Service dependency mapping                             â”‚
â”‚                                                              â”‚
â”‚  Alerts:                                                     â”‚
â”‚  â”œâ”€ Error rate > 5%                                         â”‚
â”‚  â”œâ”€ Response time > 2s                                      â”‚
â”‚  â”œâ”€ Cache hit rate < 70%                                    â”‚
â”‚  â””â”€ Pod crashes                                             â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Status**: Architecture Defined âœ…  
**Next**: Awaiting confirmation to start implementation ðŸš€
